<script>
    // --- é¡Œç›®è³‡æ–™åº« (é€šç”¨åŒ…å®¹ç‰ˆ) ---
    const questions = [
        {
            // ä¿®æ”¹é»žï¼šæŠŠã€Œå…’å¥³ã€æ”¹æˆã€Œè¦ªå‹æˆ–æ˜¯æ™šè¼©ã€ï¼Œè®“å–®èº«è€…ä¹Ÿèƒ½å¸¶å…¥ã€Œä¾„å­/å¥½å‹/é„°å±…ã€
            title: "1. è·Ÿè¦ªå‹æˆ–æ˜¯æ™šè¼©ä½å¤šé ï¼Œä½ è¦ºå¾—æœ€å‰›å¥½ï¼ŸðŸ ",
            options: [
                "ðŸ‘¨â€ðŸ‘©â€ðŸ‘§â€ðŸ‘¦ ä½åœ¨ä¸€èµ·æœ€ç†±é¬§", 
                "ðŸ² ä½éš”å£ (ä¸€ç¢—æ¹¯çš„è·é›¢)", 
                "ðŸšŒ åŒç¸£å¸‚ (æƒ³çœ‹å†åŽ»çœ‹)", 
                "âœˆï¸ è¶Šé è¶Šå¥½ (è¦–è¨Šå°±å¥½)"
            ]
        },
        {
            title: "2. åªæœ‰ä¸€å€‹äººåƒé£¯æ™‚ï¼Œä½ æœƒ...ï¼ŸðŸ±",
            options: [
                "ðŸ³ ç°¡å–®ç…®å€‹éºµ/ç‡™é’èœ", 
                "ðŸ¥¡ è²·ä¾¿ç•¶/å«å¤–é€", 
                "ðŸ§Š ç†±å†°ç®±å‰©ä¸‹çš„å‰©èœ", 
                "ðŸ¦ž è¶æ©ŸåŽ»åƒå¤§é¤"
            ]
        },
        {
            // ä¿®æ”¹é»žï¼šæŠŠã€Œå…’å¥³ã€æ”¹æˆã€Œä¿¡ä»»çš„äººã€ï¼Œå¼·èª¿çš„æ˜¯ã€Œå®‰å…¨æ„Ÿã€è€Œéžã€Œè¡€ç·£ã€
            title: "3. æœ‰å€‹ã€Œç”¨äº†å°±æœƒå ±å¹³å®‰ã€çš„ç†±æ°´ç“¶ï¼Œä½ æƒ³ç”¨å—Žï¼ŸðŸ“±",
            options: [
                "ðŸ™†â€â™€ï¸ æƒ³ç”¨ (è®“ä¿¡ä»»çš„äººå®‰å¿ƒ)", // ä¿®æ”¹æ‹¬è™Ÿå…§æ–‡å­—
                "ðŸ™…â€â™‚ï¸ ä¸æƒ³ç”¨ (æ„Ÿè¦ºè¢«ç›£è¦–)", 
                "ðŸ¤” çœ‹æ˜¯ä¸æ˜¯å…è²»çš„"
            ]
        },
        {
            title: "4. é€ä½ ä¸€å€‹æ©Ÿå™¨äººï¼Œæœ€å¸Œæœ›å®ƒå¹«ä½ åšä»€éº¼ï¼ŸðŸ¤–",
            options: [
                "ðŸ§¹ æŽƒåœ°/æ´—å»æ‰€", 
                "ðŸ‘©â€ðŸ³ ç…®é£¯/æ´—ç¢—", 
                "ðŸ’† æŒ‰æ‘©/æ¥èƒŒ", 
                "ðŸ—£ï¸ é™ªæˆ‘èŠå¤©"
            ]
        },
        {
            title: "5. (å·å·å•) è¦ºå¾—ä¸€å€‹äººä½æœ€çˆ½çš„æ˜¯ï¼ŸðŸŽ‰",
            options: [
                "ðŸ“º é›»è¦–ä¸ç”¨æ¶é™æŽ§å™¨", 
                "ðŸ¥˜ ä¸ç”¨ç…©æƒ±ç…®ä»€éº¼", 
                "â° ä½œæ¯è‡ªç”±æƒ³ç¡å°±ç¡", 
                "ðŸ©³ ç©¿è‘—éš¨ä¾¿è¶…è‡ªåœ¨"
            ]
        }
    ];

    // --- çµæžœåˆ†æžè³‡æ–™åº« (é€šç”¨åŒ…å®¹ç‰ˆ) ---
    const results = [
        {
            type: "ðŸ‘‘ éœ¸æ°£ç¨ç«‹çŽ‹",
            emoji: "ðŸ‘‘",
            desc: "æ‚¨æ˜¯ä¸€å€‹éžå¸¸æ¸…æ¥šè‡ªå·±è¦ä»€éº¼çš„äººï¼äº«å—è‡ªç”±ã€ä¸å–œæ­¡éº»ç…©åˆ¥äººã€‚å°æ‚¨ä¾†èªªï¼Œæ“æœ‰ç¨è™•çš„æ™‚é–“æ˜¯ä¸€ç¨®è‡³é«˜ç„¡ä¸Šçš„ã€Œäº«å—ã€ã€‚",
            advice: "æŠŠæ™‚é–“ç•™çµ¦è‡ªå·±ï¼Œæ‚¨å°±æ˜¯è‡ªå·±äººç”Ÿçš„åœ‹çŽ‹ï¼"
        },
        {
            type: "âœ¨ æ™ºæ…§ç”Ÿæ´»å®¶",
            emoji: "âœ¨",
            desc: "æ‚¨çš„å¿ƒæ…‹éžå¸¸å¹´è¼•ï¼å°æ–¼æ–°äº‹ç‰©æŽ¥å—åº¦é«˜ã€‚æ‚¨æ‡‚å¾—å–„ç”¨å·¥å…·ï¼ˆå¤–é€ã€å®¶é›»ï¼‰è®“ç”Ÿæ´»æ›´è¼•é¬†ï¼Œæ˜¯å¤§å®¶çœ¼ä¸­çš„æ½®äººç‰©ï¼",
            advice: "ä¿æŒå¥½å¥‡å¿ƒï¼Œç§‘æŠ€å°±æ˜¯æ‚¨çš„æœ€ä½³ç¥žéšŠå‹ã€‚"
        },
        {
            type: "â¤ï¸ æº«æš–å®ˆè­·è€…",
            emoji: "â¤ï¸",
            // ä¿®æ”¹é»žï¼šæŠŠã€Œå­©å­ã€æ”¹æˆã€Œé‡è¦çš„äººã€ï¼Œé¿å…ç„¡å­å¥³è€…çš„å¤±è½æ„Ÿ
            desc: "å°æ‚¨ä¾†èªªï¼Œäººèˆ‡äººçš„é€£çµæ˜¯æœ€é‡è¦çš„ã€‚å³ä½¿æ²’æœ‰ä½åœ¨ä¸€èµ·ï¼Œæ‚¨çš„å¿ƒä¹Ÿç¸½æ˜¯æŽ›å¿µè‘—é‚£äº›é‡è¦çš„äººã€‚æ‚¨æ˜¯å€‹æº«æŸ”ä¸”è²¼å¿ƒçš„äººã€‚",
            advice: "ç…§é¡§åˆ¥äººçš„åŒæ™‚ï¼Œåˆ¥å¿˜äº†ä¹Ÿè¦å¤šæ„›è‡ªå·±ä¸€é»žå–”ï¼"
        },
        {
            type: "ðŸŒ¿ æ¨‚æ´»è‡ªç”±æ´¾",
            emoji: "ðŸŒ¿",
            desc: "æ‚¨å¾ˆéš¨å’Œï¼Œè¦ºå¾—æ—¥å­éŽå¾—é–‹å¿ƒæœ€é‡è¦ã€‚ä¸å¼·æ±‚å®Œç¾Žï¼Œå–œæ­¡é †å…¶è‡ªç„¶ã€‚æ‚¨çš„ç”Ÿæ´»å……æ»¿äº†å°ç¢ºå¹¸ï¼Œæ˜¯æ‡‚å¾—æ”¾é¬†çš„é«˜æ‰‹ã€‚",
            advice: "ä»Šå¤©ä¸ç”¨ç…®äº†ï¼ŒåŽ»åƒé “å¥½æ–™çš„çŠ’è³žè‡ªå·±å§ï¼"
        }
    ];

    let currentStep = 0;
    let userAnswers = []; 

    const quizBox = document.getElementById('quiz-box');
    const bar = document.getElementById('bar');
    const currNum = document.getElementById('curr-num');
    const resultScreen = document.getElementById('result-screen');
    const headerArea = document.getElementById('header-area');

    // UI å…ƒç´ 
    const resTitle = document.getElementById('res-title');
    const resDesc = document.getElementById('res-desc');
    const resAdvice = document.getElementById('res-advice');
    const resEmoji = document.getElementById('res-emoji');

    function init() {
        renderQuestions();
        updateProgress();
    }

    function renderQuestions() {
        quizBox.innerHTML = '';
        questions.forEach((q, index) => {
            const card = document.createElement('div');
            card.className = `question-card ${index === 0 ? 'active' : ''}`;
            card.id = `q-${index}`;
            
            let html = `<div class="q-title">${q.title}</div><div class="options-grid">`;
            q.options.forEach((opt, optIdx) => {
                html += `<button class="option-btn" onclick="selectOption(this, ${index}, ${optIdx})">${opt}</button>`;
            });
            html += `</div>`;
            
            card.innerHTML = html;
            quizBox.appendChild(card);
        });
    }

    function selectOption(btn, step, optIdx) {
        userAnswers[step] = optIdx;
        const allBtns = btn.parentElement.children;
        for (let b of allBtns) b.classList.remove('selected');
        btn.classList.add('selected');

        setTimeout(() => {
            if (step < questions.length - 1) {
                nextQuestion(step);
            } else {
                finishQuiz();
            }
        }, 400);
    }

    function nextQuestion(step) {
        const currentCard = document.getElementById(`q-${step}`);
        const nextCard = document.getElementById(`q-${step + 1}`);
        currentCard.classList.remove('active');
        currentCard.classList.add('exit-left');
        nextCard.classList.add('active');
        currentStep++;
        updateProgress();
    }

    function updateProgress() {
        currNum.innerText = currentStep + 1;
        const percent = ((currentStep + 1) / questions.length) * 100;
        bar.style.width = `${percent}%`;
    }

    function finishQuiz() {
        headerArea.style.opacity = '0';
        
        // --- ç°¡æ˜“åˆ†æžé‚è¼¯ ---
        let finalResult;
        const q4Answer = userAnswers[3]; // ç¬¬4é¡Œ (æ©Ÿå™¨äºº)
        const q5Answer = userAnswers[4]; // ç¬¬5é¡Œ (æœ€çˆ½)

        if (q4Answer === 3) { 
            finalResult = results[2]; // æº«æš–å®ˆè­·è€…
        } else if (q4Answer === 0 || q4Answer === 1) {
            finalResult = results[1]; // æ™ºæ…§ç”Ÿæ´»å®¶
        } else if (q5Answer === 3) {
            finalResult = results[3]; // æ¨‚æ´»è‡ªç”±æ´¾
        } else {
            finalResult = results[0]; // éœ¸æ°£ç¨ç«‹çŽ‹
        }

        resTitle.innerText = finalResult.type;
        resEmoji.innerText = finalResult.emoji;
        resDesc.innerText = finalResult.desc;
        resAdvice.innerText = finalResult.advice;

        resultScreen.classList.add('show');
        startConfetti();
    }

    function startConfetti() {
        const canvas = document.getElementById("confetti-canvas");
        const ctx = canvas.getContext("2d");
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        let particles = [];
        const colors = ['#FF8C42', '#4ECDC4', '#FFD93D', '#FF6B6B', '#6C5CE7'];
        for (let i = 0; i < 120; i++) {
            particles.push({
                x: Math.random() * canvas.width,
                y: Math.random() * canvas.height - canvas.height,
                speed: Math.random() * 3 + 3,
                color: colors[Math.floor(Math.random() * colors.length)],
                size: Math.random() * 10 + 5,
                tilt: Math.random() * 10,
                tiltAngle: Math.random() * 10
            });
        }
        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            let active = false;
            particles.forEach(p => {
                p.y += p.speed;
                p.tiltAngle += 0.1;
                ctx.beginPath();
                ctx.lineWidth = p.size;
                ctx.strokeStyle = p.color;
                ctx.moveTo(p.x + p.tilt + Math.cos(p.tiltAngle) * 10, p.y);
                ctx.lineTo(p.x + p.tilt, p.y + p.size);
                ctx.stroke();
                if (p.y < canvas.height) active = true;
            });
            if (active) requestAnimationFrame(draw);
        }
        draw();
    }

    init();
</script>
